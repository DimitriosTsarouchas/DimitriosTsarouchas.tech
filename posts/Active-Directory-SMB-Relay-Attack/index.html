<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Attacking Active Directory - SMB Relay Attack" /><meta name="author" content="Dimitrios Tsarouchas" /><meta property="og:locale" content="en_US" /><meta name="description" content="Server Message Block Relay Attack Overview In an SMB Relay attack, an attacker instead of cracking the captured hashes offline relays those hashes to another machine on the same network." /><meta property="og:description" content="Server Message Block Relay Attack Overview In an SMB Relay attack, an attacker instead of cracking the captured hashes offline relays those hashes to another machine on the same network." /><link rel="canonical" href="https://dimitrios-tsarouchas.tech//posts/Active-Directory-SMB-Relay-Attack/" /><meta property="og:url" content="https://dimitrios-tsarouchas.tech//posts/Active-Directory-SMB-Relay-Attack/" /><meta property="og:site_name" content="Dimitrios Tsarouchas" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-10T02:55:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Attacking Active Directory - SMB Relay Attack" /><meta name="twitter:site" content="@DimitriosTsaro5" /><meta name="twitter:creator" content="@Dimitrios Tsarouchas" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Dimitrios Tsarouchas"},"description":"Server Message Block Relay Attack Overview In an SMB Relay attack, an attacker instead of cracking the captured hashes offline relays those hashes to another machine on the same network.","url":"https://dimitrios-tsarouchas.tech//posts/Active-Directory-SMB-Relay-Attack/","@type":"BlogPosting","headline":"Attacking Active Directory - SMB Relay Attack","dateModified":"2021-08-10T02:55:00+01:00","datePublished":"2021-08-10T02:55:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://dimitrios-tsarouchas.tech//posts/Active-Directory-SMB-Relay-Attack/"},"@context":"https://schema.org"}</script><title>Attacking Active Directory - SMB Relay Attack | Dimitrios Tsarouchas</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/me.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dimitrios Tsarouchas</a></div><br><div class="site-subtitle font-italic">Cybersecurity and CTFs</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>Home</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <script src="https://tryhackme.com/badge/44835"></script> <a href="https://github.com/DimitriosTsarouchas" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://linkedin.com/in/dimitrios-tsarouchas" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin-in"></i> </a> <a href="https://twitter.com/DimitriosTsaro5" aria-label="twitter" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['dimitristsaroucha','gmail.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-7" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Attacking Active Directory - SMB Relay Attack</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Attacking Active Directory - SMB Relay Attack</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Aug 10, 2021, 2:55 AM +0100" > Aug 10, 2021 <i class="unloaded">2021-08-10T02:55:00+01:00</i> </span> by <span class="author"> Dimitrios Tsarouchas </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1162 words">6 min</span></div></div><div class="post-content"><h2 id="server-message-block-relay-attack-overview">Server Message Block Relay Attack Overview</h2><p>In an SMB Relay attack, an attacker instead of cracking the captured hashes offline relays those hashes to another machine on the same network.</p><p><strong>For this attack to be effective, first, the SMB signing must be disabled on the target machine.</strong></p><p>SMB signing is a <a href="https://en.wikipedia.org/wiki/Packet_Layer_Protocol" target="_blank">packet-level protocol</a>. If SMB signing is enabled, when an attacker tries to relay the credentials, the machine understands that these packets are not signed by him so it does not allow him access.</p><p>Nevertheless, if SMB signing is disabled it never checks for the authenticity of where these packets are coming from. It accepts the username and the hash and let the attacker connect to that machine if he has the permission to do so.</p><p><strong>Second, the attacker has to have administrator access on that machine as well.</strong></p><p>The attacker cannot relay the credentials captured from one machine back to the same machine. It has to relay those credentials on two separate machines. <a href="#1">1</a>, <a href="#2">2</a></p><h2 id="attack-phases">Attack Phases</h2><p><strong>Step 1: Checking whether SMB is enabled or not.</strong></p><p>The attacker runs the <code class="language-plaintext highlighter-rouge">nmap --script=smb2-security-mode.nse -p445 192.168.242.0/24 </code> command.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/SMB-Enabled-and-Required-on-the-DC-and-not-required-on-clients.png" alt="SMB-Enabled-and-Required-on-the-DC-and-not-required-on-clients" /><em>SMB Enabled and Required on the DC and not required on clients</em></p><p>On the domain controller (<strong>192.168.242.139</strong>) the message signing is enabled and required.</p><p>Message signing is disabled by default in any workstation but enabled and required on every single server (or Domain Controller) by default. Therefore, the attacker is not able to relay through the domain controller, as it is a server.</p><p>However, in both client machines (<strong>192.168.242.168</strong> and <strong>192.168.242.169</strong>), the message signing is enabled but not required. That means the attacker can perform a relay attack because of that non-requirement.</p><p>The attacker grabs both client IP addresses and saves them into the <strong>targets.txt file</strong>. The attacker now will relay the credentials from 192.168.242.169 to 192.168.242.168 using <a href="https://tools.kali.org/sniffingspoofing/responder" target="_blank">Responder</a>.</p><p><strong>Step 2: Attacker modifies Responder</strong></p><p>The attacker will turn off both SMB and HTTP on the Responder’s configuration file. In that way Responder plays the role of a listener and does not respond on these services.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/SMB-and-HTTP-disabled-on-Responder.png" alt="SMB-and-HTTP-disabled-on-Responder" /><em>SMB and HTTP disabled on Responder</em></p><p><strong>Step 3: Attacker runs Responder</strong></p><p>The attacker runs Responder to listen for a response using the <code class="language-plaintext highlighter-rouge">responder -I eth0 -rwdv</code> command. Responder now is waiting for events to happen.</p><p><strong>Step 4: Attacker sets up the relay</strong></p><p>The attacker sets up a relay using the <code class="language-plaintext highlighter-rouge">ntlmrelayx.py -tf targets.txt -smb2support</code> command.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Running-ntlmrelayx.py-and-waiting-for-connections.png" alt="Running-ntlmrelayx.py-and-waiting-for-connections" /><em>Running ntlmrelayx.py and waiting for connections</em></p><p>Servers are now waiting for a connection to be established.</p><p><strong>Step 5: An event occurs</strong></p><p>User <strong>dtsarouchas</strong> wants to access the domain controller. Instead of the domain controller’s IP address, he types the attacker’s IP address.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/DNS-failure-Wrong-address.png" alt="DNS-failure-Wrong-address" /><em>DNS failure: Wrong address</em></p><p><strong>Step 6: SAM hashes have been dumped</strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Local-SAM-hashes-have-been-dumped.png" alt="Local-SAM-hashes-have-been-dumped" /><em>Local SAM hashes have been dumped</em></p><p>The authentication succeeded because SMB signing is enabled but not required and because “dtsarouchas” is the Administrator on this computer. Therefore, the SAM hashes were able to be dumped. Now the attacker can copy the SAM hashes, try cracking them offline and move laterally or vertically.</p><p>The attacker now will gain access to SMB interactive shell by using the <code class="language-plaintext highlighter-rouge">ntlmrelayx.py -tf targets.txt -smb2support -i</code> command.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Start-interactive-SMB-client-shell-via-TCP.png" alt="Start-interactive-SMB-client-shell-via-TCP" /><em>Start interactive SMB client shell via TCP</em></p><p>Now the attacker has access to the interactive shell on 127.0.0.1:11000 and will access that SMB shell using the command <code class="language-plaintext highlighter-rouge">nc 127.0.0.1 11000</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Run-netcat-to-access-the-SMB-shell.png" alt="Run-netcat-to-access-the-SMB-shell" /><em>Run netcat to access the SMB shell</em></p><p>The attacker navigates to shares where he can find ADMIN$, C$, IPC$, and Share folders. Then he uses the C$ drive and lists the files this folder has in it.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/List-the-contents-of-C$-drive.png" alt="List-the-contents-of-C$-drive" /><em>List the contents of C$ drive</em></p><p>Going a step further, he uses the ADMIN$ folder where he can add files, get files, having full control on the administrator folder and subsequently to this computer.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Listing-the-contents-of-the-ADMIN$-folder.png" alt="Listing-the-contents-of-the-ADMIN$-folder" /><em>Listing the contents of the ADMIN$ folder</em></p><h2 id="mitigating-smb-relay-attack">Mitigating SMB Relay Attack</h2><p>In order to mitigate SMB relay attacks, organisations should first enable SMB signing on all devices, which will stop the attack completely.</p><p>A downside is that it can cause performance issues with file copies. Alternatively, they could disable NTLM authentication on their network, which will completely stop the attack as well. However, if Kerberos stops working as the authentication method, Windows is going to default back to NTLM, so it is not a failsafe ultimately.</p><p>Another useful measure is Account Tiering, which limits domain admins to specific tasks. Account Tiering means that the Domain Administrator is only logging into their domain accounts and not to their user accounts. However, enforcing this policy might not be easy for an organisation.</p><p>Last but not least, organisations should restrict local administrators, which will prevent much lateral movement. However, there will be a potential increase in the amount of service desk tickets because users may complain and may want to have admin rights <a href="#3">3</a>, <a href="#4">4</a>, <a href="#5">5</a>.</p><h3 id="evaluation-of-mitigation-strategys-effectiveness">Evaluation of Mitigation Strategy’s Effectiveness</h3><p>The administrators should restrict NTLM authentication on the domain. To do that they should follow the steps below:</p><p>On the domain controller, by using <strong>Win+R</strong> type <strong>gpedit.msc</strong> that will bring on the <strong>Local Group Policy Editor</strong>.</p><p>Under <strong>Local Computer Policy</strong>, navigate to <code class="language-plaintext highlighter-rouge">Computer Configuration → Windows Settings → Security Settings → Security Options</code>.</p><p>On the right side search to find, the policy called <strong>Network Security: Restrict NTLM: NTLM authentication in this domain</strong>.</p><p>Double click on that policy and at the pop-up Window on the <strong>Local Security Setting</strong> tab using the dropdown menu select <strong>Deny All</strong>. <a href="#6">6</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Open-Group-Policy-Management-Editor.png" alt="Open-Group-Policy-Management-Editor" /><em>Open Group Policy Management Editor</em></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Deny-NTLM-authentication-in-this-domain.png" alt="Deny-NTLM-authentication-in-this-domain" /><em>Deny NTLM authentication in this domain</em></p><p>The attacker will scan against the whole network on port 445 to check if SMB signing is enabled and required using the <code class="language-plaintext highlighter-rouge">nmap --script=smb2-security-mode.nse -p445 192.168.242.0/24</code> command.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Checking-where-SMB-is-enabled-or-disabled.png" alt="Checking-where-SMB-is-enabled-or-disabled" /><em>Checking where SMB is enabled or disabled</em></p><p>On the domain controller, message signing is enabled and required, and on both client machines are enabled but not required, meaning that the attacker can relay and authenticate against the client machines. The attacker runs the <code class="language-plaintext highlighter-rouge">ntlmrelayx.py -tf targets.txt -smb2support</code> command but this time, the authentication of the user “dtsarouchas” on the domain failed on both machines.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Authentication-as-dtsarouchas-user-failed-on-both-user-machines.png" alt="Authentication-as-dtsarouchas-user-failed-on-both-user-machines" /><em>Authentication as dtsarouchas user failed on both user machines</em></p><p>The attacker goes a step further and tries to gain interactive shell access to connect to the client machine using the <code class="language-plaintext highlighter-rouge">ntlmrelayx.py -tf targets.txt -smb2support -i</code> command, but this failed as well.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Authentication-as-dtsarouchas-user-failed-and-no-interactive-shell-gained.png" alt="Authentication-as-dtsarouchas-user-failed-and-no-interactive-shell-gained" /><em>Authentication as dtsarouchas user failed and no interactive shell gained</em></p><p>It is now proved that by denying all NTLM authentication requests from the servers and accounts of the domain controller can effectively prevent the SMB Relay Attack.</p><p>In a later post we will learn another form of relaying that is more reliable than the previous attack because it utilises IPv6. Stay tuned!</p><p><strong>References</strong></p><p>[1]<a name="1"></a> <a href="https://en.wikipedia.org/wiki/SMBRelay" target="_blank">SWikipedia Contributors. SMBRelay.</a></p><p>[2]<a name="2"></a> <a href="https://www.sans.org/blog/smb-relay-demystified-and-ntlmv2-pwnage-with-python/" target="_blank">Baggett, M. (2013). SMB Relay Demystified and NTLMv2 Pwnage with Python. Sans.org.</a></p><p>[3]<a name="3"></a> <a href="https://calcomsoftware.com/mitigating-ntlm-remote-code-execution/" target="_blank">Pollack, K. (2019). Mitigating Relay NTLM Remote Code Execution. calcomsoftware.com.</a></p><p>[4]<a name="4"></a> <a href="https://blog.skullsecurity.org/2008/ms08-068-preventing-smbrelay-attacks" target="_blank">Bowes, R. (2008), ms08-068 - Preventing SMBRelay Attacks. Blog.skullsecurity.org.</a></p><p>[5]<a name="5"></a> <a href="https://www.intandemly.com/blog/tiered-approach-to-abm/" target="_blank">Intademly. (n.d.) Account Segmentation And It’s Importance. intademly.com.</a></p><p>[6]<a name="6"></a> <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-ntlm-authentication-in-this-domain" target="_blank">Microsoft Docs. (2017). Network security: Restrict NTLM: NTLM authentication in this domain. docs.microsoft.com.</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/windows/'>Windows</a>, <a href='/categories/active-directory/'>Active Directory</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/active-directory/" class="post-tag no-text-decoration" >active directory</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Attacking Active Directory - SMB Relay Attack - Dimitrios Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Active-Directory-SMB-Relay-Attack/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Attacking Active Directory - SMB Relay Attack - Dimitrios Tsarouchas&u=https://dimitrios-tsarouchas.tech//posts/Active-Directory-SMB-Relay-Attack/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Attacking Active Directory - SMB Relay Attack - Dimitrios Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Active-Directory-SMB-Relay-Attack/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tmux/">Tmux</a><li><a href="/posts/Active-Directory-SetUp/">Active Directory - Domain Controller Setup</a><li><a href="/posts/Goals-of-Security/">Goals of Security</a><li><a href="/posts/Threat-Actors/">Threat Actors</a><li><a href="/posts/Active-Directory-Post-Compromise-Enumeration/">Active Directory - Post-Compromise Enumeration</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE-2019-14287</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Active-Directory-Authentication-Mechanisms/"><div class="card-body"> <span class="timeago small" > Aug 7, 2021 <i class="unloaded">2021-08-07T01:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active Directory Authenitcation Mechanisms</h3><div class="text-muted small"><p> Windows New Technology LAN Manager vs Kerberos Authentication protocols Introduction Windows Authentication verifies that the information provided in the operating system comes from a trusted sourc...</p></div></div></a></div><div class="card"> <a href="/posts/Active-Directory-LLMNR-Poisoning/"><div class="card-body"> <span class="timeago small" > Aug 7, 2021 <i class="unloaded">2021-08-07T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active Directory - LLMNR and NBT-NS Poisoning</h3><div class="text-muted small"><p> Attacking Active Directory Active Directory plays an essential role in a corporate domain that makes it quite attractive to attackers. The service itself does not have to be the target as it can se...</p></div></div></a></div><div class="card"> <a href="/posts/Active-Directory-IPv6-Attack/"><div class="card-body"> <span class="timeago small" > Aug 12, 2021 <i class="unloaded">2021-08-12T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Attacking Active Directory - IPv6 Attack</h3><div class="text-muted small"><p> Internet Protocol version 6 Attack Overview IPv6 attack is another form of relaying and is more reliable than the previous attack because it utilises IPv6. A machine running on a Windows network t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Active-Directory-LLMNR-Poisoning/" class="btn btn-outline-primary"><p>Active Directory - LLMNR and NBT-NS Poisoning</p></a> <a href="/posts/Active-Directory-IPv6-Attack/" class="btn btn-outline-primary"><p>Attacking Active Directory - IPv6 Attack</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/DimitriosTsaro5">Dimitrios Tsarouchas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE 2019 14287</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dimitrios-tsarouchas.tech/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
