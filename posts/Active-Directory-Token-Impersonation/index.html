<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Attacking Active Directory - Token Impersonation Attack" /><meta name="author" content="Dimitrios Tsarouchas" /><meta property="og:locale" content="en_US" /><meta name="description" content="Token Impersonation Attack Overview Tokens can be thought of as cookies for a computer. They are temporary keys allowing a user to have access to a system or network without having to provide his/her credentials each time they access a file." /><meta property="og:description" content="Token Impersonation Attack Overview Tokens can be thought of as cookies for a computer. They are temporary keys allowing a user to have access to a system or network without having to provide his/her credentials each time they access a file." /><link rel="canonical" href="https://dimitrios-tsarouchas.tech//posts/Active-Directory-Token-Impersonation/" /><meta property="og:url" content="https://dimitrios-tsarouchas.tech//posts/Active-Directory-Token-Impersonation/" /><meta property="og:site_name" content="Dimitrios Tsarouchas" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-16T02:55:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Attacking Active Directory - Token Impersonation Attack" /><meta name="twitter:site" content="@DimitriosTsaro5" /><meta name="twitter:creator" content="@Dimitrios Tsarouchas" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Dimitrios Tsarouchas"},"description":"Token Impersonation Attack Overview Tokens can be thought of as cookies for a computer. They are temporary keys allowing a user to have access to a system or network without having to provide his/her credentials each time they access a file.","url":"https://dimitrios-tsarouchas.tech//posts/Active-Directory-Token-Impersonation/","@type":"BlogPosting","headline":"Attacking Active Directory - Token Impersonation Attack","dateModified":"2021-08-16T02:55:00+01:00","datePublished":"2021-08-16T02:55:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://dimitrios-tsarouchas.tech//posts/Active-Directory-Token-Impersonation/"},"@context":"https://schema.org"}</script><title>Attacking Active Directory - Token Impersonation Attack | Dimitrios Tsarouchas</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/me.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dimitrios Tsarouchas</a></div><br><div class="site-subtitle font-italic">Cybersecurity and CTFs</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>Home</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <script src="https://tryhackme.com/badge/44835"></script> <a href="https://github.com/DimitriosTsarouchas" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://linkedin.com/in/dimitrios-tsarouchas" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin-in"></i> </a> <a href="https://twitter.com/DimitriosTsaro5" aria-label="twitter" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['dimitristsaroucha','gmail.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-7" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Attacking Active Directory - Token Impersonation Attack</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Attacking Active Directory - Token Impersonation Attack</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Aug 16, 2021, 2:55 AM +0100" > Aug 16, 2021 <i class="unloaded">2021-08-16T02:55:00+01:00</i> </span> by <span class="author"> Dimitrios Tsarouchas </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="998 words">5 min</span></div></div><div class="post-content"><h2 id="token-impersonation-attack-overview">Token Impersonation Attack Overview</h2><p>Tokens can be thought of as cookies for a computer. They are temporary keys allowing a user to have access to a system or network without having to provide his/her credentials each time they access a file.</p><p>There are two types of tokens: the delegate and the impersonate token. The delegate token is used when a user logs into a machine, or they have a remote desktop session. The impersonate token (non-interactive) is used when a user has a network drive attached or a domain logon script <a href="#1">1</a>, <a href="#2">2</a>.</p><p>Therefore, in a Token Impersonation attack, an attacker can use a local administrator to impersonate another user logged on to a system, such as a Domain Admin.</p><h2 id="attack-phases">Attack Phases</h2><p><strong>Step 1: Run Metasploit and set payload to the target machine</strong></p><p>We will run Metasploit, load the <code class="language-plaintext highlighter-rouge">exploit/windows/smb/psexec</code> module <a href="#3">3</a> and set the necessary options for attacking the “<strong>MSCADMIN</strong>” computer machine. Then we will load the exploit <code class="language-plaintext highlighter-rouge">windows/x64/meterpreter/reverse_tcp</code> to gain a reverse shell <a href="#4">4</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/get_reverse_shell.png" alt="Set the parameters to attack the MSCADMIN machine and get a reverse shell" /><em>Set the parameters to attack the MSCADMIN machine and get a reverse shell</em></p><p><strong>Step 2: Run the exploit and get shell access</strong></p><p>Everything is set up, the attacker runs the <code class="language-plaintext highlighter-rouge">exploit</code> command, and gains shell access on the “<strong>MSCADMIN</strong>” computer machine and dumps the hashes using the <code class="language-plaintext highlighter-rouge">hashdump</code> command.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Gain_shell_access_3.png" alt="Gain shell access, own the MSCADMIN machine and dump the SAM hashes" /><em>Gain shell access, own the MSCADMIN machine and dump the SAM hashes</em></p><p><strong>Step 3: Loading Incognito</strong></p><p>The attacker loads Incognito <a href="#5">5</a> to impersonate a user. Using the <code class="language-plaintext highlighter-rouge">help</code> command, Incognito shows the available commands that an attacker can utilise.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Load_Incognito.png" alt="Load Incognito" /><em>Load Incognito</em></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Incognito_commands.png" alt="Incognito commands" /><em>Incognito commands</em></p><p><strong>Step 4: Listing tokens</strong></p><p>Using the <code class="language-plaintext highlighter-rouge">list_tokens -u</code> command, the attacker sees that “<strong>university\Administrator</strong>” and “<strong>university\dtsarouchas</strong>” users are in this computer machine.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/List_tokens.png" alt="List tokens" /><em>List tokens</em></p><p><strong>Step 5: Impersonating Administrator</strong></p><p>In order for the attacker to impersonate the Administrator user, he will use the <code class="language-plaintext highlighter-rouge">impersonate_token university\\Administrator</code> command (Figure 98). After the successful impersonation of the Administrator user, the attacker types the <code class="language-plaintext highlighter-rouge">shell</code> command to gain access to that computer machine, and he is now the “<strong>university\administrator</strong>” user.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Successful_impersonation.png" alt="Successful impersonation of Administrator and shell access to his machine" /><em>Successful impersonation of Administrator and shell access to his machine</em></p><p><strong>Step 5: Impersonating a User</strong></p><p>Then the attacker impersonates the “<strong>dtsarouchas</strong>” user using the <code class="language-plaintext highlighter-rouge">impersonate_token university\\dtsarouchas</code> command, gains shell access using the <code class="language-plaintext highlighter-rouge">shell</code> command, and he is now the “<strong>university\dtsarouchas</strong>” user.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/impersonation_of_dtsarouchas.png" alt="Successful impersonation of dtsarouchas user and shell access to his machine" /><em>Successful impersonation of dtsarouchas user and shell access to his machine</em></p><h2 id="token-impersonation-mitigation-strategies">Token Impersonation Mitigation Strategies</h2><p>Organisations should limit the permissions for a user or token creation, which will not entirely prevent the attack.</p><p>A better strategy is by using Account Tiering <a href="#6">6</a>. Domain Admins should be logging into the machines they need to access, which should only be the domain controllers. If for some reason a Domain Admin logs into a user computer, or a server, and that user/server computer is compromised, an attacker can impersonate that token. In an Account Tiering, users typically have two accounts, one that will use as a regular user for everyday activities, and one that will be used when they need to access the domain controller. In that way, if the regular user account is compromised, the attacker will not be able to get into the domain controller.</p><p>Typically, the administrator accounts have longer-password policies and are stricter with their permissions. Therefore, it should be repetition in policies, and if these policies are in place, they will prevent an attacker. Finally, by using the least privilege principle and removing admin privileges on local users, an attacker will be unable to get shell access in that computer with their account <a href="#7">7</a>. That prevents the attacker from getting into a computer and utilising this kind of attack.</p><h2 id="evaluation-of-mitigation-strategys-effectiveness">Evaluation of Mitigation Strategy’s Effectiveness</h2><p>Since the machines used are in a lab environment, the mitigation strategy that will be used is by implementing the least privilege principle for the user “<strong>dtsarouchas</strong>”. Since the user “<strong>dtsarouchas</strong>” does not have admin privileges, psexec module will not work. Therefore, the attacker could not gain shell access to the user’s machine. The following steps are to mitigate the Token Impersonation attack. Following the steps, Microsoft provides for implementing least privilege an administrator should configure a GPO to restrict admin accounts on domain-joined computers. <a href="#7">7</a>.To do that on the domain controller use <code class="language-plaintext highlighter-rouge">Win+R</code> and run <code class="language-plaintext highlighter-rouge">secpol.msc</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Open_security_policy_1.png" alt="Open security policy" /><em>Open security policy</em></p><p>Once the Local Security Policy window is opened, navigate to <code class="language-plaintext highlighter-rouge">Local Policies → User Right Assignments</code>. The policies that must be configured are the <code class="language-plaintext highlighter-rouge">“Deny log on through Remote Desktop Services”</code>, <code class="language-plaintext highlighter-rouge">“Deny access to this system from the network”</code>, <code class="language-plaintext highlighter-rouge">“Deny log on as a service”</code> and finally <code class="language-plaintext highlighter-rouge">“Deny log on as a batch job”</code>. By default, no user has been added to that rights.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Before_adding.png" alt="Before adding the compromised account" /><em>Before adding the compromised account</em></p><p>Administrators should add the user account “<strong>university\dtsarouchas</strong>” from these rights in order to prevent attackers who might get access to that account to pass the hash around the network and subsequently to the domain controller.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Adding_the_compromised.png" alt="Adding the compromised account" /><em>Adding the compromised account</em></p><p>The attacker will load Metasploit and use the psexec module to gain shell access to the user “<strong>dtsarouchas</strong>” machine. Then he will set a native payload to upload malware on the user’s machine in order to set up a listener.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/get_reverse_shell_1.png" alt="Set the parameters to attack the MSCADMIN machine and try to get a reverse shell" /><em>Set the parameters to attack the MSCADMIN machine and try to get a reverse shell</em></p><p>Then he will try to exploit the target machine, set up the reverse TCP listener and gain shell access.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Connection_failed.png" alt="Connection to the user's machine failed" /><em>Connection to the user’s machine failed</em></p><p>The exploit failed to connect to the user’s machine because this user account has not administrator privileges. Therefore, no session can be created with the user’s machine. A message of an SMB communication error has been returned, making the attacker unable to gain shell access and subsequently impersonate any user on the domain.</p><p>Coming up next Kerberoasting, don’t miss it as it is the most popular Active Directory attack!</p><p><br /></p><p><strong>References</strong></p><p>[1]<a name="1"></a> <a href="https://medium.com/palantir/windows-privilege-abuse-auditing-detection-and-defense-3078a403d74e/" target="_blank">Windows Privilege Abuse: Auditing, Detection, and Defense.</a></p><p>[2]<a name="2"></a> <a href="https://hunter2.gitbook.io/darthsidious/privilege-escalation/token-impersonation/" target="_blank">Token Impersonation.</a></p><p>[3]<a name="3"></a> <a href="https://www.offensive-security.com/metasploit-unleashed/psexec-pass-hash/" target="_blank">PSEXEC PASS THE HASH.</a></p><p>[4]<a name="4"></a> <a href="https://www.offensive-security.com/metasploit-unleashed/exploits/" target="_blank">WORKING WITH ACTIVE AND PASSIVE EXPLOITS IN METASPLOIT.</a></p><p>[5]<a name="5"></a> <a href="https://www.offensive-security.com/metasploit-unleashed/fun-incognito/" target="_blank">FUN WITH INCOGNITO.</a></p><p>[6]<a name="6"></a> <a href="https://www.intandemly.com/blog/tiered-approach-to-abm/" target="_blank">Account Segmentation And It’s Importance.</a></p><p>[7]<a name="7"></a> <a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models/" target="_blank">Implementing Least-Privilege Administrative Models.</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/windows/'>Windows</a>, <a href='/categories/active-directory/'>Active Directory</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/active-directory/" class="post-tag no-text-decoration" >active directory</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Attacking Active Directory - Token Impersonation Attack - Dimitrios Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Active-Directory-Token-Impersonation/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Attacking Active Directory - Token Impersonation Attack - Dimitrios Tsarouchas&u=https://dimitrios-tsarouchas.tech//posts/Active-Directory-Token-Impersonation/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Attacking Active Directory - Token Impersonation Attack - Dimitrios Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Active-Directory-Token-Impersonation/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tmux/">Tmux</a><li><a href="/posts/Active-Directory-SetUp/">Active Directory - Domain Controller Setup</a><li><a href="/posts/Goals-of-Security/">Goals of Security</a><li><a href="/posts/Threat-Actors/">Threat Actors</a><li><a href="/posts/Active-Directory-Post-Compromise-Enumeration/">Active Directory - Post-Compromise Enumeration</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE-2019-14287</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Active-Directory-Authentication-Mechanisms/"><div class="card-body"> <span class="timeago small" > Aug 7, 2021 <i class="unloaded">2021-08-07T01:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active Directory Authenitcation Mechanisms</h3><div class="text-muted small"><p> Windows New Technology LAN Manager vs Kerberos Authentication protocols Introduction Windows Authentication verifies that the information provided in the operating system comes from a trusted sourc...</p></div></div></a></div><div class="card"> <a href="/posts/Active-Directory-LLMNR-Poisoning/"><div class="card-body"> <span class="timeago small" > Aug 7, 2021 <i class="unloaded">2021-08-07T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active Directory - LLMNR and NBT-NS Poisoning</h3><div class="text-muted small"><p> Attacking Active Directory Active Directory plays an essential role in a corporate domain that makes it quite attractive to attackers. The service itself does not have to be the target as it can se...</p></div></div></a></div><div class="card"> <a href="/posts/Active-Directory-SMB-Relay-Attack/"><div class="card-body"> <span class="timeago small" > Aug 10, 2021 <i class="unloaded">2021-08-10T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Attacking Active Directory - SMB Relay Attack</h3><div class="text-muted small"><p> Server Message Block Relay Attack Overview In an SMB Relay attack, an attacker instead of cracking the captured hashes offline relays those hashes to another machine on the same network. For this ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Active-Directory-Pass-the-Hash/" class="btn btn-outline-primary"><p>Attacking Active Directory - Pass-the-Hash / Pass-the-Password Attacks</p></a> <a href="/posts/Active-Directory-Kerberoasting/" class="btn btn-outline-primary"><p>Attacking Active Directory - Kerberoast Attack</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/DimitriosTsaro5">Dimitrios Tsarouchas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE 2019 14287</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dimitrios-tsarouchas.tech/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
