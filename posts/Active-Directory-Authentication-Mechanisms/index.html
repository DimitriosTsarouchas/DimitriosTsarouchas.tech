<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Active Directory Authenitcation Mechanisms" /><meta name="author" content="Dimitrios Tsarouchas" /><meta property="og:locale" content="en_US" /><meta name="description" content="Windows New Technology LAN Manager vs Kerberos Authentication protocols Introduction Windows Authentication verifies that the information provided in the operating system comes from a trusted source such as a valid user or computer account, in order to provide access to local and network resources. Active Directory is a central location for storing identity information. Therefore, users need to be authenticated based on something only they know, such as their password." /><meta property="og:description" content="Windows New Technology LAN Manager vs Kerberos Authentication protocols Introduction Windows Authentication verifies that the information provided in the operating system comes from a trusted source such as a valid user or computer account, in order to provide access to local and network resources. Active Directory is a central location for storing identity information. Therefore, users need to be authenticated based on something only they know, such as their password." /><link rel="canonical" href="https://dimitrios-tsarouchas.tech//posts/Active-Directory-Authentication-Mechanisms/" /><meta property="og:url" content="https://dimitrios-tsarouchas.tech//posts/Active-Directory-Authentication-Mechanisms/" /><meta property="og:site_name" content="Dimitrios Tsarouchas" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-07T01:55:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Active Directory Authenitcation Mechanisms" /><meta name="twitter:site" content="@DimitriosTsaro5" /><meta name="twitter:creator" content="@Dimitrios Tsarouchas" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Dimitrios Tsarouchas"},"description":"Windows New Technology LAN Manager vs Kerberos Authentication protocols Introduction Windows Authentication verifies that the information provided in the operating system comes from a trusted source such as a valid user or computer account, in order to provide access to local and network resources. Active Directory is a central location for storing identity information. Therefore, users need to be authenticated based on something only they know, such as their password.","url":"https://dimitrios-tsarouchas.tech//posts/Active-Directory-Authentication-Mechanisms/","@type":"BlogPosting","headline":"Active Directory Authenitcation Mechanisms","dateModified":"2021-08-07T01:55:00+01:00","datePublished":"2021-08-07T01:55:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://dimitrios-tsarouchas.tech//posts/Active-Directory-Authentication-Mechanisms/"},"@context":"https://schema.org"}</script><title>Active Directory Authenitcation Mechanisms | Dimitrios Tsarouchas</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/me.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dimitrios Tsarouchas</a></div><br><div class="site-subtitle font-italic">Cybersecurity and CTFs</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>Home</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <script src="https://tryhackme.com/badge/44835"></script> <a href="https://github.com/DimitriosTsarouchas" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://linkedin.com/in/dimitrios-tsarouchas" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin-in"></i> </a> <a href="https://twitter.com/DimitriosTsaro5" aria-label="twitter" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['dimitristsaroucha','gmail.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-7" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Active Directory Authenitcation Mechanisms</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Active Directory Authenitcation Mechanisms</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Aug 7, 2021, 1:55 AM +0100" > Aug 7, 2021 <i class="unloaded">2021-08-07T01:55:00+01:00</i> </span> by <span class="author"> Dimitrios Tsarouchas </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2029 words">11 min</span></div></div><div class="post-content"><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/NTLM-vs-Kerberos.jpg" alt="NTLM vs Kerberos" /><em>Windows New Technology LAN Manager vs Kerberos Authentication protocols</em></p><h2 id="introduction">Introduction</h2><p>Windows Authentication verifies that the information provided in the operating system comes from a trusted source such as a valid user or computer account, in order to provide access to local and network resources. Active Directory is a central location for storing identity information. Therefore, users need to be authenticated based on something only they know, such as their password.</p><p>Credentials are stored locally in the <a href="https://docs.microsoft.com/en-us/windows/win32/secauthn/lsa-authentication" target="_blank">Windows Local Security Authority (LSA)</a>. When a user logs into a domain, Windows authentication packages use the credentials transparently, providing a single sign-on to network resources. Windows also use authentication through smart cards and biometric characteristics in order to provide multi-factor authentication. <a href="#1">1</a></p><h2 id="windows-logon-and-sign-in-scenarios">Windows logon and sign-in scenarios</h2><p>In order for users to access local and network resources, a valid user account is required to logon to a Windows computer. Windows computers perform user authentication using a login process to provide secure access. After successful user account authentication, the authorisation process is applied to determine the level of access that this user has to the requested resource. Users must sign-in when requesting access to application and service resources, which means valid accounts and credentials are required. It is similar to the logon (used for a hardware system when it starts up, like a computer) process with the difference that the logon information is stored in the <a href="https://en.wikipedia.org/wiki/Security_Account_Manager#:~:text=The%20Security%20Account%20Manager%20(SAM,authenticate%20local%20and%20remote%20users.&amp;text=SAM%20uses%20cryptographic%20measures%20to%20prevent%20unauthenticated%20users%20accessing%20the%20system.)" target="_blank">Security Account Management (SAM)</a> database on the local computer and in AD. In contrast, the sign-in information (account and credentials) is managed by the application or service. <a href="#2">2</a>.</p><p>There are four types of Windows logon scenarios:</p><h3 id="interactive-logon">Interactive logon</h3><p>In an interactive logon, users are asked to enter their credentials into a credential input box, or by inserting a smart card into a smart card reader, or by interacting with a biometric device. The interactive logon can be made using a local or a domain logon process. For a domain logon, credentials submitted by users contain their account name and password or a certificate, as well as information about the AD domain. It is followed by the process of comparing the user information provided with the stored data in the security database on the AD domain or user’s local computer. An interactive logon can be performed either locally, where users have physical access to a system (or when that system is part of a computer network), or remotely via <a href="https://docs.microsoft.com/en-us/windows/win32/termserv/terminal-services-portal" target="_blank">Terminal Services</a> or <a href="https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/welcome-to-rds" target="_blank">Remote Desktop Services (RDS)</a>, where the logon is qualified as remote interactive. The difference between a local logon and a domain logon is that on the local logon users are granted permissions for accessing resources on local computers in the network, while on a domain logon users are granted permissions for accessing local and domain resources. <a href="#2">2</a></p><h3 id="network-logon">Network Logon</h3><p>In a network logon, there is no dialog box collecting credentials because the account has already been authenticated. Credentials were previously collected by another method, so authentication is transparent to users unless alternate credentials are required. <a href="https://docs.microsoft.com/en-us/windows/win32/secauthn/microsoft-ntlm" target="_blank">NTLM</a>, <a href="https://www.rfc-editor.org/rfc/rfc2617.txt" target="_blank">Digest</a> and <a href="https://www.ietf.org/rfc/rfc2831.txt" target="_blank">Digest as a SALS Mechanism</a>, <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security" target="_blank">SSL/TLS</a>, <a href="https://en.wikipedia.org/wiki/Public_key_certificate" target="_blank">Public Key certificates</a> and <a href="https://docs.microsoft.com/en-us/windows/win32/com/kerberos-v5-protocol#:~:text=The%20Kerberos%20v5%20authentication%20protocol,1993%2C%20in%20document%20RFC%201510." target="_blank">Kerberos v5 protocol</a> are the authentication mechanisms included in the security system for providing network logon authentication. <a href="#2">2</a></p><h3 id="smart-cards">Smart Cards</h3><p>Smart cards are only used for connecting to a domain account, and their authentication is based on the Kerberos protocol. A user’s smart card does not use passwords, but a pair of private/public keys are stored on the smart card. The shared secret key derives from the user’s password and the private key is stored only to the user’s smartcard. <a href="#2">2</a></p><h3 id="biometric-logon">Biometric logon</h3><p>A device captures physical characteristics such as a fingerprint, the retina or the voice of a person, creates digital characteristics, and saves them in the AD database. On logon, it captures the characteristic and compares it with the data in storage. If this comparison is successful, authentication is successful. <a href="#2">2</a></p><h2 id="authentication-protocols">Authentication protocols</h2><p>As described above, Windows system uses five authentication mechanisms to provide network logon functionality. The two primary protocols Windows AD uses to authenticate user and computer accounts are the NTLM and Kerberos. An alternative for smartcard logon authentication is utilising the public key certificate and authentication within web services is mostly utilising Digest or SSL/TLS protocols.</p><h3 id="ntlm-authentication">NTLM Authentication</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/server-during-ntlm-authentication.png" alt="NTLM-Challenge/Response" /><em>NTLM Challenge/Response Process - Image by IONOS</em></p><p><strong>NTLM (New Technology LAN Manager)</strong> is a family of authentication protocols based on a challenge/response mechanism that proves to a DC that the users going to be authenticated, knows the passwords associated with their accounts. NTLM is used for local logon authentication on non-domain controllers.</p><p>When NTLM is used, the verification of a user or computer account can be done from a resource server. The resource server contacts a domain authentication service on a DC for that account. If this is a domain account, or in the case the account is local, the DC looks this account up on the local account database. <a href="#3">3</a></p><p>NTLM credentials are a combination of a domain name, a username and a one-way password hash which basically are data obtained during the interactive logon process. <a href="#4">4</a></p><p>A closer look at how NTLM authentication is working is provided below:</p><ol><li>A user provides a domain name, username, and password to a client machine, which rejects the actual password after calculating the password’s cryptographic hash.<li>The username is sent to the server in plain text by the client machine.<li>The server generates a challenge that is a 16-byte random number and sends it back to the client.<li>Using the user’s password hash, the client encrypts the challenge and sends the result, also called the response, back to the server.<li>The server sends to the DC the username as well as the client’s challenge and response.<li>The DC, using the username, retrieves the hash of the user’s password stored in the SAM database, and uses this password hash for encrypting the challenge.<li>Finally, DC makes a comparison between its computed encrypted challenge and the client’s computed response, and in case of a match, the user is authenticated. <a href="#4">4</a></ol><p>In an Active Directory environment, the preferred authentication method is Kerberos v5, although Microsoft or non-Microsoft applications may still use NTLM <a href="#3">3</a>.</p><p>Windows systems use the Microsoft Negotiate security package to select between Kerberos and NTLM authentication. This security package selects the Kerberos protocol over NTLM unless the systems involved in the authentication do not support Kerberos or the calling application has not sufficient information about it. <a href="#5">5</a></p><h3 id="kerberos-authentication">Kerberos Authentication</h3><p>Client and server authentication in Active Directory is provided by Kerberos version 5, which first appeared in Windows Server 2003 OS and is used to protect the authentication between the client and server in an open network. Kerberos is an open standard described in RFC 4120. <a href="#6">6</a></p><p>Any application or service that supports Kerberos can work with Active Directory. The main advantage of the Kerberos protocol is that instead of using secrets, which are at risk of being sniffed by malicious users, it uses a common symmetric cryptographic key. Kerberos took its name from the three-headed dog in Greek mythology, and the reason is that it has three main components, a client, a server and a trusted authority that issues secret keys. The trusted authority is called <strong>Key Distribution Center (KDC)</strong>. It is installed as part of the DC and is responsible for the <strong>Authentication Service (AS)</strong> as well as the <strong>Ticket-Granting Service (TGS)</strong>. <a href="#7">7</a></p><p>In a typical key exchange, when users log in to the system, they must prove to KDC that they are whom they claim to be. First, the user provides to the KDC the username along with a long-time key that is generated based on the user’s password. The Kerberos client, in this case, the user’s computer, accepts the user’s password and generates the cryptographic key. A copy of that key is also maintained in KDC’s database. By receiving the request, the KDC compares the username and the long-term key with its records. If this information is accurate, the KDC responds to the user with a session key. This session key is called <strong>Ticket-Granting Ticket (TGT)</strong>. <a href="#7">7</a></p><p>A Ticket-Granting Ticket contains a copy of the session key that is encrypted with the KDC’s long-term key and is used by the KDC to communicate with the user. The TGT also contains the session key. The user uses the TGT to communicate with the KDC, which is encrypted with the user’s long-term key so that only the specific user can decrypt. This session key is stored in the volatile memory of the user’s machine. Future communication between the KDC and the user will be based on that session key which has a <strong>TTL</strong> value for a temporary usage.</p><p>When the user request access to the server needs to contact the KDC using the session key provided. TGT and timestamp, are encrypted by the session key and the <strong>service ID</strong> included in the user’s request. In order for the KDC to retrieve the session key, once it receives that request from the user, it makes use of its long-term key to decrypt the TGT and decrypts the timestamp by using the session key. The time difference must be less than five minutes to make sure the request came from a specific user. Since KDC confirms the request as legitimate, creates a new ticket called <strong>service ticket</strong>. The service ticket contains one key for the server and one key for the user, both including the user’s name, the server, the timestamp, the TTL value and a new session key. One of these keys is encrypted with the user’s long-term key and the other one with the server’s long-term key. Both are encrypted together with the session key between the user and the KDC.</p><p>When the ticket is sent to the user, it decrypts it using the session key and decrypts his key by using his long-term key. The above process reveals a new session key that is shared between the user and the server. The user then creates a new request, including the server’s key. Once that key is sent to the server, it decrypts its key with its long-term key and retrieves the session key. The server uses that session key to verify the request’s authenticity by decrypting the timestamp. <a href="#7">7</a>, <a href="#8">8</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Kerberos-mechanism.png" alt="Kerberos Authentication" /><em>Kerberos Authentication. Source: https://adsecurity.org</em></p><p>Let us see how <strong>Kerberos</strong> works <a href="#3">3</a>, <a href="#9">9</a>:</p><ul><li>The user sends an <strong>AS_REQ</strong> message to the KDC. That message is encrypted with the user’s NTLM hash.<li>The KDC sends back the TGT as an <strong>AS_REP</strong> and encrypts it with the <strong>Kerberos TGT (krbtgt) hash</strong>.<li>The user sends a <strong>TGS_REQ</strong> message to the KDC to request the <strong>TGS ticket</strong> from the KDC presenting his TGT.<li>The KDC is not able to know if the user has access to the application server so is going to provide back to the user <strong>the TGS with the application server’s account hash</strong>.<li>In order for the user to authenticate to the application server, he presents the TGS to the application server, and <strong>the application server will decrypt it using its hash</strong>.<li>The application server will send back a response if the user can access that service or not.</ul><p>When the user requests <strong>a Ticket Granting Service (TGS)</strong> from the KDC, they use <strong>a Service Principal Name (SPN)</strong> and that SPN should be associated with at least one service logon account. <a href="#9">9</a></p><p>So far we have discussed the purpose of a Windows Active Directory and its main authentication mechanisms. In later posts we will learn where Active Directory is vulnerable and why and how these Active Directory attacks work. Stay tuned!</p><p><strong>References</strong></p><p>[1]<a name="1"></a> <a href="https://docs.microsoft.com/en-us/windows-server/security/windows-authentication/windows-authentication-concepts" target="_blank">Microsoft Docs. (2016). Windows Authentication Concepts.</a></p><p>[2]<a name="2"></a> <a href="https://docs.microsoft.com/en-us/windows-server/security/windows-authentication/windows-logon-scenarios" target="_blank">Microsoft Docs. (2016). Windows Logon Scenarios.</a></p><p>[3]<a name="3"></a> <a href="https://docs.microsoft.com/en-us/windows-server/security/kerberos/ntlm-overview" target="_blank">Microsoft Docs. (2016) NTLM Overview.</a></p><p>[4]<a name="4"></a> <a href="https://docs.microsoft.com/en-us/windows/win32/secauthn/microsoft-ntlm" target="_blank">Microsoft Docs. (2018). Microsoft NTLM.</a></p><p>[5]<a name="5"></a> <a href="https://docs.microsoft.com/en-us/windows/win32/secauthn/microsoft-negotiate" target="_blank">Microsoft Docs. (2018) Microsoft Negotiate.</a></p><p>[6]<a name="6"></a> <a href="https://tools.ietf.org/html/rfc4120" target="_blank">Neuman, C., Hartman, S., Yu, T. and Raeburn, K. (2005). The Kerberos Network Authentication Service (V5).</a>.</p><p>[7]<a name="7"></a> Desmond, B., Richards, J., Allen, R. and Lowe-Norris. (2013). Active Directory. 5th ed. United States of America, CA: O’Reilly Media, chap. 1-2, 5, 9-10.</p><p>[8]<a name="8"></a> Francis, D. (2017). Mastering Active Directory. Birmingham: Packt Publishing Limited, chap. 1-2, 5, 10, 15.</p><p>[9]<a name="9"></a> <a href="https://adsecurity.org/?p=2011" target="_blank">Metcalf, S. (2015). Active Directory Security: How Attackers Use Kerberos Silver Tickets to Exploit Systems.</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/windows/'>Windows</a>, <a href='/categories/active-directory/'>Active Directory</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/active-directory/" class="post-tag no-text-decoration" >active directory</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Active Directory Authenitcation Mechanisms - Dimitrios Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Active-Directory-Authentication-Mechanisms/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Active Directory Authenitcation Mechanisms - Dimitrios Tsarouchas&u=https://dimitrios-tsarouchas.tech//posts/Active-Directory-Authentication-Mechanisms/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Active Directory Authenitcation Mechanisms - Dimitrios Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Active-Directory-Authentication-Mechanisms/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tmux/">Tmux</a><li><a href="/posts/Active-Directory-SetUp/">Active Directory - Domain Controller Setup</a><li><a href="/posts/Goals-of-Security/">Goals of Security</a><li><a href="/posts/Threat-Actors/">Threat Actors</a><li><a href="/posts/Active-Directory-Post-Compromise-Enumeration/">Active Directory - Post-Compromise Enumeration</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE-2019-14287</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Active-Directory-LLMNR-Poisoning/"><div class="card-body"> <span class="timeago small" > Aug 7, 2021 <i class="unloaded">2021-08-07T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active Directory - LLMNR and NBT-NS Poisoning</h3><div class="text-muted small"><p> Attacking Active Directory Active Directory plays an essential role in a corporate domain that makes it quite attractive to attackers. The service itself does not have to be the target as it can se...</p></div></div></a></div><div class="card"> <a href="/posts/Active-Directory-SMB-Relay-Attack/"><div class="card-body"> <span class="timeago small" > Aug 10, 2021 <i class="unloaded">2021-08-10T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Attacking Active Directory - SMB Relay Attack</h3><div class="text-muted small"><p> Server Message Block Relay Attack Overview In an SMB Relay attack, an attacker instead of cracking the captured hashes offline relays those hashes to another machine on the same network. For this ...</p></div></div></a></div><div class="card"> <a href="/posts/Active-Directory-IPv6-Attack/"><div class="card-body"> <span class="timeago small" > Aug 12, 2021 <i class="unloaded">2021-08-12T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Attacking Active Directory - IPv6 Attack</h3><div class="text-muted small"><p> Internet Protocol version 6 Attack Overview IPv6 attack is another form of relaying and is more reliable than the previous attack because it utilises IPv6. A machine running on a Windows network t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Active-Directory/" class="btn btn-outline-primary"><p>Active Directory</p></a> <a href="/posts/Active-Directory-LLMNR-Poisoning/" class="btn btn-outline-primary"><p>Active Directory - LLMNR and NBT-NS Poisoning</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/DimitriosTsaro5">Dimitrios Tsarouchas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE 2019 14287</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dimitrios-tsarouchas.tech/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
