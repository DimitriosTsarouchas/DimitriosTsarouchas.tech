<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Active Directory - LLMNR and NBT-NS Poisoning" /><meta name="author" content="Dimitrios Tsarouchas" /><meta property="og:locale" content="en_US" /><meta name="description" content="Attacking Active Directory Active Directory plays an essential role in a corporate domain that makes it quite attractive to attackers. The service itself does not have to be the target as it can serve as a means of providing a route for breach of other systems connected to it." /><meta property="og:description" content="Attacking Active Directory Active Directory plays an essential role in a corporate domain that makes it quite attractive to attackers. The service itself does not have to be the target as it can serve as a means of providing a route for breach of other systems connected to it." /><link rel="canonical" href="https://dimitrios-tsarouchas.tech//posts/Active-Directory-LLMNR-Poisoning/" /><meta property="og:url" content="https://dimitrios-tsarouchas.tech//posts/Active-Directory-LLMNR-Poisoning/" /><meta property="og:site_name" content="Dimitrios Tsarouchas" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-07T02:55:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Active Directory - LLMNR and NBT-NS Poisoning" /><meta name="twitter:site" content="@DimitriosTsaro5" /><meta name="twitter:creator" content="@Dimitrios Tsarouchas" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Dimitrios Tsarouchas"},"description":"Attacking Active Directory Active Directory plays an essential role in a corporate domain that makes it quite attractive to attackers. The service itself does not have to be the target as it can serve as a means of providing a route for breach of other systems connected to it.","url":"https://dimitrios-tsarouchas.tech//posts/Active-Directory-LLMNR-Poisoning/","@type":"BlogPosting","headline":"Active Directory - LLMNR and NBT-NS Poisoning","dateModified":"2021-08-07T02:55:00+01:00","datePublished":"2021-08-07T02:55:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://dimitrios-tsarouchas.tech//posts/Active-Directory-LLMNR-Poisoning/"},"@context":"https://schema.org"}</script><title>Active Directory - LLMNR and NBT-NS Poisoning | Dimitrios Tsarouchas</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/me.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dimitrios Tsarouchas</a></div><br><div class="site-subtitle font-italic">Cybersecurity and CTFs</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>Home</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <script src="https://tryhackme.com/badge/44835"></script> <a href="https://github.com/DimitriosTsarouchas" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://linkedin.com/in/dimitrios-tsarouchas" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin-in"></i> </a> <a href="https://twitter.com/DimitriosTsaro5" aria-label="twitter" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['dimitristsaroucha','gmail.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-7" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Active Directory - LLMNR and NBT-NS Poisoning</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Active Directory - LLMNR and NBT-NS Poisoning</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Aug 7, 2021, 2:55 AM +0100" > Aug 7, 2021 <i class="unloaded">2021-08-07T02:55:00+01:00</i> </span> by <span class="author"> Dimitrios Tsarouchas </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1287 words">7 min</span></div></div><div class="post-content"><h2 id="attacking-active-directory">Attacking Active Directory</h2><p>Active Directory plays an essential role in a corporate domain that makes it quite attractive to attackers. The service itself does not have to be the target as it can serve as a means of providing a route for breach of other systems connected to it.</p><p>As Charles Kolodgy said, most organisations do not have adequate security measures on their Active Directory. This is based on the findings of a research that showed that 97% of the companies who use AD believe that it is a critical part of their company and should be safeguarded as possible. A high percentage of them also (71%) believes that a recovery after an AD attack would be very difficult if not impossible <a href="#1">1</a>, <a href="#2">2</a>.</p><p>The following are the most common attacks used by adversaries to break into Active Directory.</p><p>A prerequisite for the success of the following attacks is the deactivation of any antivirus software.</p><h2 id="llmnr-and-nbt-ns-poisoning">LLMNR and NBT-NS Poisoning</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/LLMNR-Poisoning.jpg" alt="LLMNR poisoning" /><em>LLMNR poisoning</em></p><h3 id="overview">Overview</h3><p>LLMNR stand for <strong>Link-Local Multicast Name Resolution</strong>, and NBT-NS stands for <strong>NetBIOS Name Service</strong>. LLMNR and NBT-NS used to identify hosts when DNS is unable to do it.</p><p>The difference between them is that LLMNR is based on the DNS format allowing hosts to perform name resolution for other hosts that are on the same local link. At the same time, NBT-NS identifies systems by their NetBIOS name on a local network. <a href="#3">3</a></p><p>When a user responds to this service, the service responds with a username and a password hash, giving the attacker the most valuable information to compromise a domain.</p><h3 id="vulnerability">Vulnerability</h3><p>The attacker listens to the UDP ports <strong>5355</strong> or <strong>135</strong> that are related to LLMNR and NBT-NS respectively. He broadcasts and responds to them, pretending that he knows the location of the requested host. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/LLMNR-Poisoning-Process.png" alt="LLMNR poisoning process" /><em>LLMNR poisoning process - Image by technologysolutions</em></p><p>Let us analyse the steps from the above figure: <a href="#4">4</a></p><ol><li>The VICTIM wants to connect to the hackme server at <strong>\hackme</strong>, but mistakenly typed in <strong>\hackm</strong><li>The DNS server responds to VICTIM saying that it does not know that host.<li>The VICTIM asks then if anyone in the network (multicasts) knows the location of \hackm.<li>The HACKER responds to the VICTIM saying that he knows where the \hackm is, and that he needs the credentials to log in the VICTIM.<li>The VICTIM believes the HACKER and sends its username and NTLMv2 hash to the HACKER.<li>The HACKER can now crack the hash to discover the password. Note: The HACKER can use various methods to make the VICTIM type his IP or domain name, instead of waiting for him to do it by mistake. Nevertheless, these methods will not be analysed here, as they are not related to AD’s functionality.</ol><h3 id="attack-phases">Attack Phases</h3><p>The attacker uses a tool (Responder) to perform a man in the middle attack. When an event occurs (someone mistyped the network drive), a DNS failure happens. Responder captures the IP address of the client machine, the username and the NTLMv2 hash. The attacker gets the hash and then he can try to crack it using a tool designed for this purpose, like <strong>Hashcat</strong>. <a href="#5">5</a></p><h4 id="step-1-the-attacker-runs-responder-to-capture-hashes">Step 1: The attacker runs Responder to capture hashes</h4><p>The attacker uses the following command to capture hashes:</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">root@kali:~#</span><span class="w"> </span>responder –I eth0 –rwdv
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Responder-waiting-for-requests.png" alt="Responder waiting for requests" /><em>Responder waiting for requests</em></p><p>After Responder is loaded, it is in the middle waiting for any requests. It needs to be run when the network has high traffic.</p><h4 id="step-2-an-event-occurs-dns-failure">Step 2: An event occurs (DNS failure)</h4><p>The user tried to open a file share but instead of pointing to the domain controller’s IP address at 192.168.242.139, mistypes and points to the attacker’s IP address at 192.168.242.138. The Windows Security dialog box pops up informing the user that access is denied to that domain.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/DNS-failure-Access-Denied.png" alt="DNS failure - Access Denied" /><em>DNS failure - Access Denied</em></p><h4 id="step-3-attacker-grabs-the-hashes">Step 3: Attacker grabs the hashes</h4><p>While the event occurred, Responder captured the NTLMv2 user hash, the IP address of the user’s machine, and the username. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Responder-captured-user-information.png" alt="Responder captured user information" /><em>Responder captured user information</em></p><h4 id="step-4-attacker-cracks-the-hashes-using-hashcat">Step 4: Attacker cracks the hashes using Hashcat.</h4><p>Hashcat is a tool utilised to crack hashes. Since the attacker has to crack an NTLMv2 hash, he will use the module <strong>5600</strong>. Because the attacker’s machine is hosted in a virtual environment, he needs to use the <strong>–force</strong>, forcing Hashcat to run over CPU instead of a GPU. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/NTLM-Module.png" alt="NTLMv2 module" /><em>NTLMv2 module</em></p><p>The attacker runs the</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">root@kali:~#</span><span class="w"> </span>hashcat –m 5600 university-ntlmhashes.txt rockyou.txt –force
</pre></table></code></div></div><p>command and tries to crack the hashes that saved in the <strong>“university-ntlmhases.txt”</strong> file against the wordlist <strong>“rockyou.txt”</strong>. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Cracking-the-captured-Hashes.png" alt="NTLMv2 module" /><em>Cracking the captured hashes against a wordlist with Hashcat</em></p><p>Hashcat cracked the NTLMv2 hash of the user and revealed the password that is <strong>“Password1”</strong>. That is precisely the password of that user, as shown in the figure below.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/NTLMv2-hash-cracked-and-password-revealed.png" alt="NTLMv2 hash cracked and password has been revealed" /><em>NTLMv2 hash cracked and password has been revealed</em></p><p>If the passwords are weak and guessable, such as the above situation, the attacker will be able to crack those hashes very fast.</p><p>A weak password is considered when it is less than fourteen characters long and has no complexity at the same time. When the attacker gets the password in plain text, it leverages the account to get to a machine.</p><p>Most organisations do not have an effective password policy and are still using LLMNR and NBT-NS, which makes them an easy prey for an attacker who wants to get the initial foothold.</p><h3 id="llmnr-poisoning-mitigation">LLMNR Poisoning Mitigation</h3><p>Administrators should disable both LLMNR and NBT-NS. Disabling just LLMNR is not enough because if DNS fails it goes to LLMNR and if LLMRN fails, it goes to NBT-NS.</p><h4 id="disabling-llmnr">Disabling LLMNR</h4><p>To disable LLMNR navigate to <strong>Local Group Policy Editor</strong> using <strong>Win + R</strong> and run <strong>gpedit.msc</strong>. Under</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Local Computer Policy → Computer Configuration → Administrative Templates → Network → DNS Client
</pre></table></code></div></div><p>, double click on <strong>“Turn Off Multicast Name Resolution”</strong> on the popup window select <strong>“Enabled”</strong> then click <strong>“Apply”</strong> and “OK”. <a href="#6">6</a> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Disable-LLMNR-protocol.png" alt="Disable LLMNR protocol" /><em>Disable LLMNR protocol</em></p><h4 id="disabling-nbt-ns">Disabling NBT-NS</h4><p>To disable NBT-NS navigate to</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Network Connections → Network Adapter Properties → TCP/IPv4 Properties
</pre></table></code></div></div><p>click on the <strong>“Advanced”</strong> button go to <strong>“WINS”</strong> tab and select <strong>“Disable NetBIOS over TCP/IP”</strong> and click “OK”. <a href="#7">7</a> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Disable-NBT-NS.png" alt="Disable NBT-NS protocol" /><em>Disable NBT-NS protocol</em></p><p>In case an organisation cannot disable LLMNR or NBT-NS, it must first require Network Access Control <a href="#8">8</a>, meaning that no one can go and plugin to any port in the organisation’s network and gain access.</p><p>However, only MAC addresses that belong to the organisation’s network should be allowed. If the MAC address does not belong to the network or it is not allowed, they must shut that port down.</p><p>Second, the organisation must make use of a strong password policy, because the longer and complex the password is, the harder is for an attacker to crack the password hash.</p><p>A strong password policy could be a password that avoids common word usage and is greater than 14 characters long. <a href="#9">9</a></p><p>In a later post we will learn how an attacker relays the obtained hashes to another machine on the same network. Stay tuned!</p><p><strong>References</strong></p><p>[1]<a name="1"></a> <a href="https://www.semperis.com/press-release/84-of-organizations-report-that-the-impact-of-an-active-directory-outage-would-be-significant-severe-or-catastrophic-in-the-latest-semperis-study/" target="_blank">Semperis Tech. (2020). 84% Of Organizations Report That the Impact of an Active Directory Outage Would Be Significant, Severe, or Catastrophic in the Latest Semperis Study.</a></p><p>[2]<a name="2"></a> <a href="https://www.semperis.com/new-survey-reveals-dangerous-gaps-in-crisis-management-plans%e2%80%af/" target="_blank">Semperis Tech. (2020). New survey reveals dangerous gaps in crisis management plans. Semperis.com</a></p><p>[3]<a name="3"></a> <a href="https://attack.mitre.org/techniques/T1557/001/" target="_blank">Kuehn, E., Demaske, M., Adaptforward, (2020). Man-in-the-Middle: LLMNR/NBT-NS Poisoning And SMB Relay.</a></p><p>[4]<a name="4"></a> <a href="https://technologysolutions.northstate.net/insights/pen-testing-techniques-for-internal-enterprise-network-attacks-llmnr-and-nbt-ns-poisoning/" target="_blank">Heath, A., (2018). Pen Testing Techniques for Internal Enterprise Network Attacks: LLMNR and NBT-NS Poisoning. technologysolutions.northstate.net.</a></p><p>[5]<a name="5"></a> <a href="https://hashcat.net/hashcat/" target="_blank">Hashcat.net, (2020). Advanced Password Recovery. Hashcat’s Official Website.</a></p><p>[6]<a name="6"></a> <a href="https://docs.vmware.com/en/VMware-Workspace-ONE-UEM/2011/WS1_KCD_SEGV2/GUID-0B7E3C5E-CCFE-4A5E-B990-5C8196D0B084.html" target="_blank">Vmware Docs. (2019). Disable LLMNR with Active Directory GPO. vmware.com.</a></p><p>[7]<a name="7"></a> <a href="https://blog.techguard.com/the-roi-of-security-awareness-training-0#:~:text=LLMNR%20and%20NBT%2DNS%20are,IP%20address%20of%20a%20resource." target="_blank">LLMNR, NBT-NS, DNS and other acronyms I can own your network with ;) TECHGUARD BLOG.</a></p><p>[8]<a name="8"></a> <a href="https://www.cisco.com/c/en_uk/products/security/what-is-network-access-control-nac.html" target="_blank">Cisco. (n.d.) What Is Network Access Control. cisco.com.</a></p><p>[9]<a name="9"></a> <a href="https://specopssoft.com/blog/password-length-best-practices/" target="_blank">Specops. (2020). Password length best practices. Specopssoft.com.</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/windows/'>Windows</a>, <a href='/categories/active-directory/'>Active Directory</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/active-directory/" class="post-tag no-text-decoration" >active directory</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Active Directory - LLMNR and NBT-NS Poisoning - Dimitrios Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Active-Directory-LLMNR-Poisoning/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Active Directory - LLMNR and NBT-NS Poisoning - Dimitrios Tsarouchas&u=https://dimitrios-tsarouchas.tech//posts/Active-Directory-LLMNR-Poisoning/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Active Directory - LLMNR and NBT-NS Poisoning - Dimitrios Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Active-Directory-LLMNR-Poisoning/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tmux/">Tmux</a><li><a href="/posts/Active-Directory-SetUp/">Active Directory - Domain Controller Setup</a><li><a href="/posts/Goals-of-Security/">Goals of Security</a><li><a href="/posts/Threat-Actors/">Threat Actors</a><li><a href="/posts/Active-Directory-Post-Compromise-Enumeration/">Active Directory - Post-Compromise Enumeration</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE-2019-14287</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Active-Directory-Authentication-Mechanisms/"><div class="card-body"> <span class="timeago small" > Aug 7, 2021 <i class="unloaded">2021-08-07T01:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active Directory Authenitcation Mechanisms</h3><div class="text-muted small"><p> Windows New Technology LAN Manager vs Kerberos Authentication protocols Introduction Windows Authentication verifies that the information provided in the operating system comes from a trusted sourc...</p></div></div></a></div><div class="card"> <a href="/posts/Active-Directory-SMB-Relay-Attack/"><div class="card-body"> <span class="timeago small" > Aug 10, 2021 <i class="unloaded">2021-08-10T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Attacking Active Directory - SMB Relay Attack</h3><div class="text-muted small"><p> Server Message Block Relay Attack Overview In an SMB Relay attack, an attacker instead of cracking the captured hashes offline relays those hashes to another machine on the same network. For this ...</p></div></div></a></div><div class="card"> <a href="/posts/Active-Directory-IPv6-Attack/"><div class="card-body"> <span class="timeago small" > Aug 12, 2021 <i class="unloaded">2021-08-12T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Attacking Active Directory - IPv6 Attack</h3><div class="text-muted small"><p> Internet Protocol version 6 Attack Overview IPv6 attack is another form of relaying and is more reliable than the previous attack because it utilises IPv6. A machine running on a Windows network t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Active-Directory-Authentication-Mechanisms/" class="btn btn-outline-primary"><p>Active Directory Authenitcation Mechanisms</p></a> <a href="/posts/Active-Directory-SMB-Relay-Attack/" class="btn btn-outline-primary"><p>Attacking Active Directory - SMB Relay Attack</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/DimitriosTsaro5">Dimitrios Tsarouchas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE 2019 14287</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dimitrios-tsarouchas.tech/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
