<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Attacking Active Directory - IPv6 Attack" /><meta name="author" content="Dimitrios Tsarouchas" /><meta property="og:locale" content="en_US" /><meta name="description" content="Internet Protocol version 6 Attack Overview IPv6 attack is another form of relaying and is more reliable than the previous attack because it utilises IPv6." /><meta property="og:description" content="Internet Protocol version 6 Attack Overview IPv6 attack is another form of relaying and is more reliable than the previous attack because it utilises IPv6." /><link rel="canonical" href="https://dimitrios-tsarouchas.tech//posts/Active-Directory-IPv6-Attack/" /><meta property="og:url" content="https://dimitrios-tsarouchas.tech//posts/Active-Directory-IPv6-Attack/" /><meta property="og:site_name" content="Dimitrios Tsarouchas" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-12T02:55:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Attacking Active Directory - IPv6 Attack" /><meta name="twitter:site" content="@DimitriosTsaro5" /><meta name="twitter:creator" content="@Dimitrios Tsarouchas" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Dimitrios Tsarouchas"},"description":"Internet Protocol version 6 Attack Overview IPv6 attack is another form of relaying and is more reliable than the previous attack because it utilises IPv6.","url":"https://dimitrios-tsarouchas.tech//posts/Active-Directory-IPv6-Attack/","@type":"BlogPosting","headline":"Attacking Active Directory - IPv6 Attack","dateModified":"2021-08-12T02:55:00+01:00","datePublished":"2021-08-12T02:55:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://dimitrios-tsarouchas.tech//posts/Active-Directory-IPv6-Attack/"},"@context":"https://schema.org"}</script><title>Attacking Active Directory - IPv6 Attack | Dimitrios Tsarouchas</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/me.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dimitrios Tsarouchas</a></div><br><div class="site-subtitle font-italic">Cybersecurity and CTFs</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>Home</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <script src="https://tryhackme.com/badge/44835"></script> <a href="https://github.com/DimitriosTsarouchas" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://linkedin.com/in/dimitrios-tsarouchas" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin-in"></i> </a> <a href="https://twitter.com/DimitriosTsaro5" aria-label="twitter" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['dimitristsaroucha','gmail.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-7" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Attacking Active Directory - IPv6 Attack</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Attacking Active Directory - IPv6 Attack</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Aug 12, 2021, 2:55 AM +0100" > Aug 12, 2021 <i class="unloaded">2021-08-12T02:55:00+01:00</i> </span> by <span class="author"> Dimitrios Tsarouchas </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1415 words">7 min</span></div></div><div class="post-content"><h2 id="internet-protocol-version-6-attack-overview">Internet Protocol version 6 Attack Overview</h2><p>IPv6 attack is another form of relaying and is more reliable than the <a href="https://dimitrios-tsarouchas.tech/posts/Active-Directory-SMB-Relay-Attack/">previous attack</a> because it utilises IPv6.</p><p>A machine running on a Windows network typically runs on IPv4 and chances are the network is not even utilising IPv6. If the machine utilises IPv4, but IPv6 is turned on, then there is no DNS service for IPv6.</p><p>As a result, the attacker listens for all these IPv6 messages pretending to be the DNS server. Then, the client machine will send all the IPv6 traffic to him. When this happens, the attacker can get authentication to the domain controller via LDAP or SMB.</p><p>When users log into the network, their credentials which are in an NTLM form are delivered to the attacker’s machine. The attacker relays the NTLM credentials to the domain controller, and this is called an LDAP relay.</p><p>In case the user is a Domain Admin, the attacker using LDAP logs in and creates a new account on the domain controller, which he can use later to login into the domain controller <a href="#1">1</a>, <a href="#2">2</a>.</p><p>For this attack to be successful, the domain controller must be configured to have installed a certificate to run LDAP secure and second the attacker machine must have installed a tool called mitm6 <a href="#3">3</a>.</p><h2 id="attack-phases">Attack Phases</h2><p><strong>Step 1: Attacker runs mitm6 and ntlmrelayx tools.</strong></p><p>So to begin with this attack we need spin mitm6 up using <code class="language-plaintext highlighter-rouge">mitm6 -d university.local</code> and we are getting replies from different devices in our network. From here we also need to setup a relay attack using <code class="language-plaintext highlighter-rouge">ntlmrelayx.py -6 -t ldaps://192.168.242.139 -wh maliciouswpad -l loot</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/AssigningDNS.png" alt="The attacker as DNS assigns IPv6 address to the client and waits for connections to happen" /><em>SMB Enabled and Required on the DC and not required on clients</em></p><p><strong>Step 2: Client computer restarted</strong></p><p>The <strong>dtsarouchas</strong> client computer is restarted in order to speed up the process of assigning an IPv6 address from the attacker DNS to the client (IPv6 is sending out a reply looking for a DNS every 30 minutes). When the client machine is restarted it will try to authenticate.</p><p><strong>Step 3:Information is stored in the loot folder</strong></p><p>Information about the domain is stored in the <strong>loot</strong> folder, and we can check deeper to find any useful information.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/AssigningDNS.png" alt="Information about the target is stored in the loot folder" /><em>Information about the target is stored in the loot folder</em></p><p>We are going to check the <strong>domain_users_by_group.html</strong> file as we’re after the Domain Admins. The administrator in the description field of the SQLService used the password (<strong>Password123@</strong>), and now it is visible to us!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/domain_admins.jpg" alt="The attacker checked the Domain Admins and found the password for the SQLService in the description field" /><em>The attacker checked the Domain Admins and found the password for the SQLService in the description field</em></p><p>Administrators think that the descriptions are not visible, but the attacker managed to see them. The computer was capable of accessing the domain controller via LDAPS, logging into it and dumping out any useful information to the attacker. Now the attacker has valuable information in his hands. He can see who the Domain Admins, Enterprise Admins, and Domain Users are and generally, and who he needs to attack in this environment.</p><p><strong>Step 4: An administrator logs into the client machine</strong></p><p>It is possible for the attack to take effect and target LDAPS when an administrator logs into the client machine. We can get in through the command and we’re able to create a new user account. First, we set up an access control list <strong>ACL</strong> (Figure 1) and then create a new user (Figure 2). Now as attackers we own this domain.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/LDAPS_ACLS.png" alt="Access the DC via LDAPS and create ACLs" /><em>Access the DC via LDAPS and create ACLs</em></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Users_OU.png" alt="Creating a new user in Users OU" /><em>Creating a new user in Users OU</em></p><p>Checking the Users OU in the AD’s Users and Computers, the administrator can find there the new user with the name of <strong>“epIz0yDyAX”</strong>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/AD's_Users_OU.png" alt="User is created in the AD's Users OU" /><em>User is created in the AD’s Users OU</em></p><h2 id="ipv6-attack--mitigation">IPv6 Attack – Mitigation</h2><p>As it turned out, even in a Windows IPv4 network, this attack can be useful because Windows still query for an IPv6 address. For that reason, organisations must block DHCPv6 traffic as well as incoming router ads through a group policy that should be implemented on the Windows Firewall. Nevertheless, disabling IPv6 can cause unwanted side effects <a href="#4">4</a>.</p><ul><li><p>The following rules shown in the figures below must be applied to the Windows Firewall to prevent this attack.</p><ul><li>Block the connection on Core Networking – Dynamic Host Configuration Protocol for IPv6 (DHCPV6-In)<li>Block the connection on Core Networking – Dynamic Host Configuration Protocol for IPv6 (DHCPV6-Out)<li>Block the connection on Core Networking – Router Advertisement (ICMPv6-In)</ul></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/DHCPV6-In.png" alt="Block the connection for DHCPV6-In" /><em>Block the connection for DHCPV6-In</em> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/DHCPV6-Out.png" alt="Block the connection for DHCPV6-Out" /><em>Block the connection for DHCPV6-Out</em> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Router_Advertisement.png" alt="Block the connection for DHCPV6-Out" /><em>Block the connection for Router Advertisement</em></p><ul><li>Disable the <strong>“WinHttpAutoProxySvc”</strong> service in case WPAD is not used internally and set a registry change via command prompt: REG add <code class="language-plaintext highlighter-rouge">"HKLM\SYSTEM\CurrentControlSet\services\WinHttpAutoProxySvc" /v Start /t REG_DWORD /d 4 /f</code> <a href="#5">5</a>.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/WinHttpAutoProxySvc.png" alt="Disable the WinHttpAutoProxySvc service" /><em>Disable the WinHttpAutoProxySvc service</em></p><ul><li>LDAP signing and channel binding must be enabled for avoiding LDAP/LDAPS relaying <a href="#6">6</a>. To enable LDAP singing, open the Registry Editor and navigate to <code class="language-plaintext highlighter-rouge">"Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters"</code> create the <code class="language-plaintext highlighter-rouge">REG_DWORD: "ldapserverintegrity"</code> and set the <code class="language-plaintext highlighter-rouge">"Value data"</code> field to <code class="language-plaintext highlighter-rouge">"2"</code>.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Enable_LDAP_singing.png" alt="Enable LDAP singing in the registry" /><em>Enable LDAP singing in the registry</em></p><p>Another way to enable LDAP signing is by using Group Policy, which is described in Microsoft’s Support website <a href="#7">7</a>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/LDAP_signing.png" alt="Enable LDAP signing via group policy" /><em>Enable LDAP signing via group policy</em></p><p>To enable LDAP channel binding, open the Registry Editor and navigate to <code class="language-plaintext highlighter-rouge">"Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters"</code> and create the <code class="language-plaintext highlighter-rouge">REG_DWORD: "LdapEnforceChannelBinding"</code> and set the <code class="language-plaintext highlighter-rouge">"Value data"</code> field to <code class="language-plaintext highlighter-rouge">"2"</code>. For compatibility with older OSs (Windows server 2008 and earlier) set the value to “1”. Note that the <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8563" target="_blank">CVE-2017-8563</a> update must be installed to avoid any compatibility issues. <a href="#8">8</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/LDAP_channel.png" alt="Enable LDAP channel binding in the registry" /><em>Enable LDAP channel binding in the registry</em></p><ul><li><p>User impersonation through delegation can be mitigated by putting administrators to the <strong>Protected Users Group</strong>. That will prevent credentials being abused when users log in to the devices (Windows 8.1 and Windows Server 2012 or higher) <a href="#9">9</a>.</p><p>Another way is marking these accounts as <strong>“Account is sensitive and cannot be delegated”</strong> <a href="#10">10</a>.</p></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Prevent_delegation.png" alt="Prevent delegation to sensitive accounts" /><em>Prevent delegation to sensitive accounts</em></p><ul><li>Restrict NTLM authentication <a href="#11">11</a>.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Deny_NTLM.png" alt="Deny NTLM authentication via group policy" /><em>Deny NTLM authentication via group policy</em></p><ul><li><p>Microsoft suggests in implementing a registry fix to <strong>“Prefer IPv4 over IPv6”</strong> <a href="#12">12</a>.</p><p>Open the Registry Editor. Navigate to <code class="language-plaintext highlighter-rouge">"Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters"</code> double-click on <code class="language-plaintext highlighter-rouge">REG_DWORD: "DisabledComponents"</code> and set the <code class="language-plaintext highlighter-rouge">"Value data"</code> field to <code class="language-plaintext highlighter-rouge">HEX 0x20</code> or <code class="language-plaintext highlighter-rouge">DEC 32</code>.</p></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Prefer_IPv4.png" alt="Prefer IPv4 over IPv6 in the registry" /><em>Prefer IPv4 over IPv6 in the registry</em></p><p>Another way to prefer IPv4 over IPv6 is by using the command prompt and run the following REG ADD <code class="language-plaintext highlighter-rouge">"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" /v DisabledComponents /t REG_DWORD /d 32 /f</code></p><h2 id="evaluation-of-mitigation-strategys-effectiveness">Evaluation of Mitigation Strategy’s Effectiveness</h2><p>The attacker uses the <code class="language-plaintext highlighter-rouge">mitm6 -d university.local</code> and the <code class="language-plaintext highlighter-rouge">ntlmrelayx.py -6 -t ldaps://192.168.242.139 -wh maliciouswpad -l LOOTME</code> commands.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Assign_IPv6.png" alt="Assign IPv6 address as DNS and wait for connections to happen" /><em>Assign IPv6 address as DNS and wait for connections to happen</em></p><p>The user reboots his machine, and the attacker waits for mitm6 to assign a new IPv6 address as he pretends to be the DNS server. After the client machine rebooted, mitm6 assigned an IPv6 address to it. Sadly, for the attacker, no server connections started meaning that he cannot relay via LDAPS.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/IPv6_address_assigned.png" alt="IPv6 address assigned by DNS but no connection started" /><em>IPv6 address assigned by DNS but no connection started</em></p><p>The attacker searches for the “<strong>LOOTME</strong>” folder inside “<strong>/opt/mitm6</strong>” folder where he set up the relay, but nothing comes up which proves that the attack was unsuccessful.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/No_LOOTME.png" alt="No LOOTME folder is created" /><em>No LOOTME folder is created</em></p><p>When an administrator logs into the client machine, creating a new user is enabled, and the attacker can use that for his benefit as it happened before the mitigation took place.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/Administrator_logs.png" alt="Administrator logs into the user's machine" /><em>Administrator logs into the user’s machine</em></p><p>Now, when the Administrator logs into the client machine, no new user is created. The attacker is now unable to get into the domain controller and that consequently renders the attack impossible.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/No_connection.png" alt="No connection started with the target machine" /><em>No connection started with the target machine</em></p><p>Checking the AD Users and Computers, one can now see that there is not any new user account. Therefore, the attacker has no account to access the machine.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/AD/No_new_user.png" alt="No new user is created in the AD's Users OU" /><em>No new user is created in the AD’s Users OU</em></p><p><strong>References</strong></p><p>[1]<a name="1"></a> <a href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/" target="_blank">Fox IT. (2018). mitm6 – compromising IPv4 networks via IPv6. blog.fox-it.com.</a></p><p>[2]<a name="2"></a> <a href="https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904" target="_blank">A Complete Guide on IPv6 Attack and Defense. 1st ed.</a></p><p>[3]<a name="3"></a> <a href="https://github.com/fox-it/mitm6" target="_blank">Man In The Middle 6 Tool.</a></p><p>[4]<a name="4"></a> <a href="https://dirkjanm.io/worst-of-both-worlds-ntlm-relaying-and-kerberos-delegation/" target="_blank">The worst of both worlds: Combining NTLM Relaying and Kerberos delegation.</a></p><p>[5]<a name="5"></a> <a href="https://social.technet.microsoft.com/Forums/en-US/bb0d5d52-085c-4d63-a6ce-9ca7807f01fa/completely-remove-wpad-use-of-windows-proxy-auto-discovery-windows-from-client-systems?forum=win10itprogeneral#:~:text=Create%20a%20GPO%20and%20set,to%20reboot%20the%20workstation%20TWICE" target="_blank">Completely remove WPAD (Use of Windows Proxy Auto Discovery) - Windows from client systems.</a></p><p>[6]<a name="6"></a> <a href="https://support.microsoft.com/en-gb/help/4520412/2020-ldap-channel-binding-and-ldap-signing-requirements-for-windows" target="_blank">2020 LDAP channel binding and LDAP signing requirements for Windows.</a></p><p>[7]<a name="7"></a> <a href="https://support.microsoft.com/en-us/help/935834/how-to-enable-ldap-signing-in-windows-server" target="_blank">How to enable LDAP signing in Windows Server.</a></p><p>[8]<a name="8"></a> <a href="https://support.microsoft.com/en-gb/help/4034879/how-to-add-the-ldapenforcechannelbinding-registry-entry" target="_blank">Use the LdapEnforceChannelBinding registry entry to make LDAP authentication over SSL/TLS more secure.</a></p><p>[9]<a name="9"></a> <a href="https://petri.com/windows-server-protected-privileged-accounts" target="_blank">Protected Privileged Accounts.</a></p><p>[10]<a name="10"></a> <a href="https://www.sans.org/blog/protecting-privileged-domain-accounts-safeguarding-access-tokens/" target="_blank">Protecting Privileged Domain Accounts: Safeguarding Access Tokens.</a></p><p>[11]<a name="11"></a> <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-ntlm-authentication-in-this-domain" target="_blank">Network security: Restrict NTLM: NTLM authentication in this domain.</a></p><p>[12]<a name="12"></a> <a href="https://support.microsoft.com/en-gb/help/929852/guidance-for-configuring-ipv6-in-windows-for-advanced-users" target="_blank">Guidance for configuring IPv6 in Windows for advanced users.</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/windows/'>Windows</a>, <a href='/categories/active-directory/'>Active Directory</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/active-directory/" class="post-tag no-text-decoration" >active directory</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Attacking Active Directory - IPv6 Attack - Dimitrios Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Active-Directory-IPv6-Attack/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Attacking Active Directory - IPv6 Attack - Dimitrios Tsarouchas&u=https://dimitrios-tsarouchas.tech//posts/Active-Directory-IPv6-Attack/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Attacking Active Directory - IPv6 Attack - Dimitrios Tsarouchas&url=https://dimitrios-tsarouchas.tech//posts/Active-Directory-IPv6-Attack/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tmux/">Tmux</a><li><a href="/posts/Active-Directory-SetUp/">Active Directory - Domain Controller Setup</a><li><a href="/posts/Goals-of-Security/">Goals of Security</a><li><a href="/posts/Threat-Actors/">Threat Actors</a><li><a href="/posts/Active-Directory-Post-Compromise-Enumeration/">Active Directory - Post-Compromise Enumeration</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE-2019-14287</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Active-Directory-Authentication-Mechanisms/"><div class="card-body"> <span class="timeago small" > Aug 7, 2021 <i class="unloaded">2021-08-07T01:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active Directory Authenitcation Mechanisms</h3><div class="text-muted small"><p> Windows New Technology LAN Manager vs Kerberos Authentication protocols Introduction Windows Authentication verifies that the information provided in the operating system comes from a trusted sourc...</p></div></div></a></div><div class="card"> <a href="/posts/Active-Directory-LLMNR-Poisoning/"><div class="card-body"> <span class="timeago small" > Aug 7, 2021 <i class="unloaded">2021-08-07T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active Directory - LLMNR and NBT-NS Poisoning</h3><div class="text-muted small"><p> Attacking Active Directory Active Directory plays an essential role in a corporate domain that makes it quite attractive to attackers. The service itself does not have to be the target as it can se...</p></div></div></a></div><div class="card"> <a href="/posts/Active-Directory-SMB-Relay-Attack/"><div class="card-body"> <span class="timeago small" > Aug 10, 2021 <i class="unloaded">2021-08-10T02:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Attacking Active Directory - SMB Relay Attack</h3><div class="text-muted small"><p> Server Message Block Relay Attack Overview In an SMB Relay attack, an attacker instead of cracking the captured hashes offline relays those hashes to another machine on the same network. For this ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Active-Directory-SMB-Relay-Attack/" class="btn btn-outline-primary"><p>Attacking Active Directory - SMB Relay Attack</p></a> <a href="/posts/Active-Directory-Post-Compromise-Enumeration/" class="btn btn-outline-primary"><p>Active Directory - Post-Compromise Enumeration</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/DimitriosTsaro5">Dimitrios Tsarouchas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/information-security/">information security</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apts/">APTs</a> <a class="post-tag" href="/tags/cia-triad/">cia triad</a> <a class="post-tag" href="/tags/cve-2019-14287/">CVE 2019 14287</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dimitrios-tsarouchas.tech/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
